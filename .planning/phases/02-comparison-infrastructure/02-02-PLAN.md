---
phase: 02-comparison-infrastructure
plan: 02
type: execute
wave: 2
depends_on: []
files_modified:
  - .planning/comparison-viewer/index.html
  - .planning/comparison-viewer/viewer.css
  - .planning/comparison-viewer/viewer.js
autonomous: true

must_haves:
  truths:
    - "Viewer HTML has side-by-side three-column layout"
    - "Viewer CSS provides responsive styling"
    - "Viewer JavaScript has state management and update functions"
    - "UI files are ready for server integration in 02-04"
  artifacts:
    - path: ".planning/comparison-viewer/index.html"
      provides: "Main viewer UI with side-by-side image layout"
      min_lines: 40
    - path: ".planning/comparison-viewer/viewer.css"
      provides: "Viewer styling with responsive layout"
      min_lines: 30
    - path: ".planning/comparison-viewer/viewer.js"
      provides: "Client-side comparison logic (viewport switching, page selection)"
      min_lines: 60
  key_links:
    - from: ".planning/comparison-viewer/index.html"
      to: ".planning/comparison-viewer/viewer.css"
      via: "link rel stylesheet"
      pattern: "viewer\\.css"
    - from: ".planning/comparison-viewer/index.html"
      to: ".planning/comparison-viewer/viewer.js"
      via: "script src"
      pattern: "viewer\\.js"
---

<objective>
Create the static UI files for the visual comparison viewer - HTML structure, CSS styling, and client-side JavaScript logic.

Purpose: Build the viewer interface independently from server infrastructure. This plan focuses purely on front-end files that will be served by Express in plan 02-04.

Output: Complete viewer UI files (HTML, CSS, JS) ready for server integration.
</objective>

<execution_context>
@/home/deck/.claude/get-shit-done/workflows/execute-plan.md
@/home/deck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-comparison-infrastructure/02-CONTEXT.md
@.planning/phases/02-comparison-infrastructure/02-RESEARCH.md

# Plan 02-01 provides comparison image structure this viewer will consume
@.planning/phases/02-comparison-infrastructure/02-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create viewer HTML structure</name>
  <files>.planning/comparison-viewer/index.html</files>
  <action>
    Create .planning/comparison-viewer/index.html with:

    1. Header with title "VP Associates - Visual Comparison Viewer"
    2. Controls section:
       - Page selector dropdown (populated from comparison.json)
       - Viewport tabs: Mobile | Tablet | Desktop
       - Comparison run selector (for historical comparisons)
    3. Main image display area with three columns:
       - "Baseline" (old site)
       - "Current" (new implementation)
       - "Diff" (pixel differences highlighted)
    4. Each column has:
       - Image element
       - Label showing page/viewport
       - Independent scrolling (per CONTEXT.md decision)
    5. Footer with diff statistics (diff percentage, pixel count)

    Use semantic HTML5: header, main, section, footer.
    Link to viewer.css and viewer.js.

    Note: Image src will use placeholder paths initially - these will be wired to real paths in plan 02-04 when Express server is created.
  </action>
  <verify>test -f .planning/comparison-viewer/index.html && grep -q "<img" .planning/comparison-viewer/index.html</verify>
  <done>HTML structure with side-by-side layout and controls</done>
</task>

<task type="auto">
  <name>Task 2: Create viewer CSS styling</name>
  <files>.planning/comparison-viewer/viewer.css</files>
  <action>
    Create .planning/comparison-viewer/viewer.css with:

    1. Modern, clean styling using CSS custom properties
    2. Responsive grid layout for three image columns
    3. Viewport tabs with active state styling
    4. Image containers with:
       - Max-width 100% to prevent overflow
       - Box shadow for depth
       - Border radius
       - Light background for diff visibility
    5. Controls section with:
       - Flexbox layout for controls
       - Styled dropdown and tabs
       - Hover states for interactivity
    6. Mobile-friendly: columns stack vertically on small screens

    Use a neutral color scheme (grays, white) to let images stand out.
    Diff images should be clearly distinguishable (magenta highlights).
  </action>
  <verify>test -f .planning/comparison-viewer/viewer.css && grep -q "grid\\|flex" .planning/comparison-viewer/viewer.css</verify>
  <done>CSS with responsive layout and control styling</done>
</task>

<task type="auto">
  <name>Task 3: Create viewer JavaScript logic</name>
  <files>.planning/comparison-viewer/viewer.js</files>
  <action>
    Create .planning/comparison-viewer/viewer.js with:

    1. State management:
       - currentPage (default: first page)
       - currentViewport (default: mobile)
       - currentComparison (default: latest timestamp)

    2. Functions:
       - loadComparisonList(): fetch available comparison runs
       - loadComparison(timestamp): load comparison.json metadata
       - updateImages(): update img src based on current selections
       - updateStats(): display diff percentage and pixel count

    3. Event listeners:
       - Page dropdown change: update currentPage, refresh images
       - Viewport tab click: update currentViewport, refresh images
       - Comparison selector change: load different historical comparison

    4. Image paths constructed as:
       - /comparisons/{timestamp}/{page}/{viewport}.png (current)
       - /comparisons/{timestamp}/{page}/baseline-{viewport}.png
       - /comparisons/{timestamp}/{page}/diff-{viewport}.png

    5. Error handling: show placeholder if image fails to load

    Initialize on DOMContentLoaded with latest comparison loaded.

    Note: API endpoints (/api/comparisons, /api/comparisons/latest) will be created in plan 02-04.
  </action>
  <verify>test -f .planning/comparison-viewer/viewer.js && grep -q "fetch\\|addEventListener" .planning/comparison-viewer/viewer.js</verify>
  <done>JavaScript with comparison loading and image update logic</done>
</task>

</tasks>

<verification>
After completion, verify:
- [ ] index.html has side-by-side three-column layout
- [ ] viewer.css has responsive grid and control styling
- [ ] viewer.js has comparison loading and event handling
- [ ] HTML links to CSS and JS files correctly
- [ ] All three UI files exist in .planning/comparison-viewer/
</verification>

<success_criteria>
1. Viewer UI files exist (HTML, CSS, JS)
2. HTML has complete structure with controls and image containers
3. CSS provides responsive layout
4. JavaScript has state management and update functions
5. Files are ready for Express server integration in plan 02-04
</success_criteria>

<output>
After completion, create `.planning/phases/02-comparison-infrastructure/02-02-SUMMARY.md`

Include in SUMMARY:
- UI file locations
- Styling decisions made (at Claude's discretion per CONTEXT.md)
- Any JavaScript state management patterns used
</output>
