---
phase: 08-section-polish---services
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - pages/services/[slug].vue
autonomous: true

must_haves:
  truths:
    - "Service detail page header displays hero image with dark overlay (60/50/70% neutral gradient)"
    - "Service icon box remains visible superimposed on hero background"
    - "Service title and standard badge display in white text over hero"
    - "'How This Service Works' section displays 4-step process (Consultation, Design, Review, Support)"
    - "Process section displays between capabilities and related projects"
    - "Process steps show numbered circles with connecting lines on desktop"
    - "'Related Services' section displays 3 services dynamically (same category as current service)"
    - "Related Services replaces static 'Other Services' section"
  artifacts:
    - path: "pages/services/[slug].vue"
      provides: "Service detail page with hero image, process section, and dynamic related services"
      min_lines: 350
  key_links:
    - from: "pages/services/[slug].vue"
      to: "serviceHeroImage"
      via: "computed property mapping service slug to project image"
      pattern: "computed.*hero.*image"
    - from: "pages/services/[slug].vue"
      to: "relatedServices"
      via: "computed property filtering same-category services"
      pattern: "computed.*related.*services"
    - from: "pages/services/[slug].vue"
      to: "processSection"
      via: "template section with 4 steps"
      pattern: "How This Service Works"
---

<objective>
Enhance service detail page with hero image background using Phase 3 project images, add "How This Service Works" 4-step process section, and implement dynamic "Related Services" replacing static "Other Services".

Purpose: Service detail pages need visual parity with Projects pages. Hero images using related project photos create thematic connection. The generic 4-step process section (same for all services) helps users understand the service workflow. Dynamic related services (same category) improve discoverability over hardcoded services.

Output: Enhanced service detail page with hero image background, overlay treatment, 4-step process section, and dynamic related services based on category matching.
</objective>

<execution_context>
@/home/deck/.claude/get-shit-done/workflows/execute-plan.md
@/home/deck/.claude/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-section-polish---services/08-CONTEXT.md
@.planning/phases/08-section-polish---services/08-RESEARCH.md
@pages/services/[slug].vue
@pages/services/index.vue
@public/images/image-mapping.json
</context>

<tasks>

<task type="auto">
  <name>Add hero image background to service detail page header</name>
  <files>pages/services/[slug].vue</files>
  <action>
    Modify pages/services/[slug].vue to add hero image background:

    1. Add service-to-hero-image mapping (after staticServices object, line ~390):
       const serviceHeroImages: Record<string, string> = {
         'structural-steel-design': '/images/projects/steel-connect-1920w.webp',
         'concrete-design': '/images/projects/lowrise-1920w.webp',
         'masonry-design': '/images/projects/lowrise-1920w.webp',
         'wood-design': '/images/projects/lowrise-1920w.webp',
         'foundation-design': '/images/projects/shallowdeepfoundationdesign10-1920w.webp',
         'seawall-design': '/images/projects/shallowdeepfoundationdesign10-1920w.webp',
         'steel-connection-design': '/images/projects/steel-connect-1920w.webp',
         'cad-3d-modeling': '/images/projects/cad-drawing-1920w.webp',
         'inspection-services': '/images/projects/inspection-services-1920w.webp',
         'steel-detailing': '/images/projects/shopdrawing-1920w.webp'
       }

       const heroFallback = '/images/hero/home-header-1920w.webp'

       const serviceHeroImage = computed(() => {
         return serviceHeroImages[slug] || heroFallback
       })

    2. Modify Page Header section (lines 32-56) to include hero background:
       Find the AppSection with bg-color="primary-dark" and replace with:
       <AppSection bg-color="primary-dark" padding="lg" class="relative overflow-hidden">
         <!-- Background Image -->
         <div class="absolute inset-0">
           <NuxtImg
             :src="serviceHeroImage"
             :alt="`${service?.title?.rendered || 'Service'} hero image`"
             class="w-full h-full object-cover"
             format="webp"
             loading="eager"
             width="1920"
             height="600"
           />
           <div class="absolute inset-0 bg-gradient-to-r from-black/70 via-black/50 to-black/70"></div>
         </div>

         <div class="container text-white relative z-10">
           <!-- Existing header content with white text -->
           <NuxtLink to="/services" class="inline-flex items-center gap-2 text-white/80 hover:text-white mb-6 transition-colors">
             <Icon name="mdi:arrow-left" class="w-5 h-5" />
             Back to Services
           </NuxtLink>
           <div class="flex items-center gap-4 mb-6">
             <div v-if="serviceIcon" class="w-16 h-16 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm">
               <Icon :name="serviceIcon" class="w-8 h-8" />
             </div>
             <div>
               <div v-if="serviceStandard" class="text-secondary font-semibold mb-1">{{ serviceStandard }}</div>
               <h1 class="text-4xl md:text-5xl font-display font-bold">
                 {{ service?.title?.rendered }}
               </h1>
             </div>
           </div>
           <p class="text-xl opacity-90 max-w-3xl">
             {{ serviceDescription }}
           </p>
         </div>
       </AppSection>

    3. Add NuxtImg to imports if needed (should be auto-imported in Nuxt 3)
  </action>
  <verify>npm run dev, navigate to http://localhost:3000/services/structural-steel-design, verify hero image displays with dark overlay, verify white text remains readable, verify icon box shows with white/10 background, test other service slugs to confirm different hero images</verify>
  <done>Hero image displays as full-width background, dark overlay gradient (from-black/70 via-black/50 to-black/70) ensures text readability, white text displays over overlay, icon box shows with white/10 background and backdrop-blur, fallback image loads for unmapped services</done>
</task>

<task type="auto">
  <name>Add 'How This Service Works' 4-step process section</name>
  <files>pages/services/[slug].vue</files>
  <action>
    Add process section between capabilities and related projects:

    1. Locate the Capabilities AppSection (ends around line 122)

    2. Insert new process section after capabilities (after line 122, before Related Projects section):
       <!-- How This Service Works -->
       <AppSection bg-color="neutral-50" animate-on-scroll>
         <div class="text-center mb-12">
           <h2 class="text-4xl font-display font-bold text-neutral-900 mb-4">
             How This Service Works
           </h2>
           <p class="text-xl text-neutral-600 max-w-3xl mx-auto">
             Our proven process from consultation to support
           </p>
         </div>

         <div class="grid md:grid-cols-4 gap-8">
           <div class="relative text-center">
             <div class="bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl mx-auto mb-4">1</div>
             <h3 class="text-xl font-bold text-neutral-900 mb-2">Consultation</h3>
             <p class="text-neutral-600 text-sm">Initial project review and scope discussion</p>
             <div class="hidden md:block absolute top-6 left-full w-full h-0.5 bg-primary/20 -translate-x-6"></div>
           </div>

           <div class="relative text-center">
             <div class="bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl mx-auto mb-4">2</div>
             <h3 class="text-xl font-bold text-neutral-900 mb-2">Design</h3>
             <p class="text-neutral-600 text-sm">Structural analysis and calculation preparation</p>
             <div class="hidden md:block absolute top-6 left-full w-full h-0.5 bg-primary/20 -translate-x-6"></div>
           </div>

           <div class="relative text-center">
             <div class="bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl mx-auto mb-4">3</div>
             <h3 class="text-xl font-bold text-neutral-900 mb-2">Review</h3>
             <p class="text-neutral-600 text-sm">Plan preparation and permitting support</p>
             <div class="hidden md:block absolute top-6 left-full w-full h-0.5 bg-primary/20 -translate-x-6"></div>
           </div>

           <div class="text-center">
             <div class="bg-primary text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl mx-auto mb-4">4</div>
             <h3 class="text-xl font-bold text-neutral-900 mb-2">Support</h3>
             <p class="text-neutral-600 text-sm">Construction administration and field services</p>
           </div>
         </div>
       </AppSection>

    Note: This matches the process section from the services listing page (lines 141-178 of index.vue) but without the "Our Process" heading - it's "How This Service Works" for detail pages.
  </action>
  <verify>npm run dev, navigate to any service detail page, verify "How This Service Works" section displays between capabilities and related projects, verify 4 steps display in numbered circles, verify connecting lines show on desktop (hidden on mobile), verify steps are Consultation, Design, Review, Support</verify>
  <done>Process section displays with 4 numbered steps, steps show Consultation, Design, Review, Support labels with descriptions, connecting lines display on desktop between steps, section uses neutral-50 background, responsive layout collapses to single column on mobile</done>
</task>

<task type="auto">
  <name>Replace static 'Other Services' with dynamic 'Related Services'</name>
  <files>pages/services/[slug].vue</files>
  <action>
    Replace static "Other Services" with dynamic "Related Services" based on category:

    1. Add all services array for related services lookup (after staticServices, line ~390):
       const allServicesList = [
         { title: 'Structural Steel Design', slug: 'structural-steel-design', icon: 'mdi:beam', description: 'AISC certified steel design' },
         { title: 'Concrete Design', slug: 'concrete-design', icon: 'mdi:cube-outline', description: 'ACI certified concrete design' },
         { title: 'Masonry Design', slug: 'masonry-design', icon: 'mdi:wall', description: 'ACI 530 compliant masonry design' },
         { title: 'Wood Design', slug: 'wood-design', icon: 'mdi:tree', description: 'NDS standards for wood construction' },
         { title: 'Foundation Design', slug: 'foundation-design', icon: 'mdi:home-floor-0', description: 'Deep and shallow foundations' },
         { title: 'Seawall Design', slug: 'seawall-design', icon: 'mdi:waves', description: 'Coastal protection structures' },
         { title: 'Steel Connection Design', slug: 'steel-connection-design', icon: 'mdi:vector-arrange-above', description: 'Detailed steel connection design' },
         { title: 'CAD & 3D Modeling', slug: 'cad-3d-modeling', icon: 'mdi:cube-scan', description: 'Advanced CAD and BIM modeling' },
         { title: 'Inspection Services', slug: 'inspection-services', icon: 'mdi:magnify-scan', description: 'Professional structural inspection' },
         { title: 'Steel Detailing', slug: 'steel-detailing', icon: 'mdi:pencil-ruler', description: 'Professional steel detailing' }
       ]

    2. Add service-to-category mapping (same as listing page):
       function getServiceCategory(serviceSlug: string): string | null {
         const categoryMap: Record<string, string> = {
           'structural-steel-design': 'structural',
           'concrete-design': 'structural',
           'masonry-design': 'structural',
           'wood-design': 'structural',
           'foundation-design': 'structural',
           'steel-connection-design': 'design',
           'cad-3d-modeling': 'design',
           'steel-detailing': 'design',
           'inspection-services': 'inspection',
           'seawall-design': 'marine'
         }
         return categoryMap[serviceSlug] || null
       }

    3. Replace otherServices ref with relatedServices computed (around line 451):
       const relatedServices = computed(() => {
         const currentCategory = getServiceCategory(slug)
         if (!currentCategory) return []

         // Get services in same category, excluding current
         const sameCategory = allServicesList.filter(s =>
           getServiceCategory(s.slug) === currentCategory && s.slug !== slug
         )

         // Return up to 3
         return sameCategory.slice(0, 3)
       })

    4. Update template section (lines 149-180), replace "Other Services" with:
       <!-- Related Services -->
       <AppSection v-if="relatedServices.length > 0" bg-color="neutral-100" animate-on-scroll>
         <div class="text-center mb-12">
           <h2 class="text-4xl font-display font-bold text-neutral-900 mb-4">
             Related Services
           </h2>
           <p class="text-xl text-neutral-600 max-w-3xl mx-auto">
             Explore other services that may fit your project needs
           </p>
         </div>

         <div class="grid md:grid-cols-3 gap-6">
           <ServiceCard
             v-for="relatedService in relatedServices"
             :key="relatedService.slug"
             :title="relatedService.title"
             :slug="relatedService.slug"
             :description="relatedService.description"
             :icon="relatedService.icon"
           />
         </div>

         <div class="text-center mt-12">
           <NuxtLink
             to="/services"
             class="inline-flex items-center gap-2 px-6 py-3 border-2 border-primary text-primary rounded-lg font-semibold hover:bg-primary hover:text-white transition-colors"
           >
             View All Services
             <Icon name="mdi:arrow-right" class="w-5 h-5" />
           </NuxtLink>
         </div>
       </AppSection>

    5. Remove the old otherServices ref (line 451) since we replaced it with computed
  </action>
  <verify>npm run dev, navigate to structural-steel-design, verify related services show other structural services (concrete, masonry, wood, foundation), navigate to inspection-services, verify related services empty (only one in inspection category), verify "View All Services" link displays</verify>
  <done>Related Services section displays up to 3 services from same category, current service excluded from results, section uses ServiceCard component, heading changed from "Other Services" to "Related Services", description updated to "Explore other services that may fit your project needs", View All Services link displays at bottom</done>
</task>

</tasks>

<verification>
1. Build completes without errors: npm run build
2. Service detail page header displays hero image with dark overlay
3. Hero image varies by service (uses mapped project images)
4. Dark overlay gradient ensures text readability (from-black/70 via-black/50 to-black/70)
5. Service icon box displays with white/10 background over hero
6. "How This Service Works" section displays 4-step process
7. Process steps are: Consultation, Design, Review, Support
8. Connecting lines display between steps on desktop
9. "Related Services" section displays services from same category
10. Current service is excluded from related services
</verification>

<success_criteria>
- Hero image background displays on all service detail pages
- Dark overlay treatment (60/50/70% gradient) ensures white text readability
- Hero images sourced from Phase 3 project images per mapping
- Fallback image used when no mapping exists
- "How This Service Works" section displays between capabilities and related projects
- 4-step process shows Consultation, Design, Review, Support
- Process steps display with numbered circles and descriptions
- Connecting lines show on desktop between steps 1-2, 2-3, 3-4
- "Related Services" section dynamically shows same-category services
- Current service excluded from related services results
</success_criteria>

<output>
After completion, create `.planning/phases/08-section-polish---services/08-02-SUMMARY.md`
</output>
