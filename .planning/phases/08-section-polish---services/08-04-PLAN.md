---
phase: 08-section-polish---services
plan: 04
type: execute
wave: 2
depends_on:
  - 08-01
  - 08-02
  - 08-03
files_modified:
  - .planning/phases/08-section-polish---services/08-04-VERIFICATION.md
  - .planning/scripts/capture-services-screenshots.ts
  - .planning/scripts/compare-services-screenshots.ts
autonomous: false

must_haves:
  truths:
    - "All 5 Phase 8 success criteria verified PASS"
    - "Services listing page displays all services with proper card layout"
    - "Service detail pages show full content with proper formatting"
    - "Service-related images migrated and displaying correctly"
    - "Category/filtering functionality works as expected"
    - "Visual comparison shows no regressions from live site baseline"
  artifacts:
    - path: ".planning/phases/08-section-polish---services/08-04-VERIFICATION.md"
      provides: "Verification report with all 5 success criteria PASS status"
      min_lines: 100
    - path: ".planning/scripts/capture-services-screenshots.ts"
      provides: "Screenshot capture script for services pages"
      min_lines: 150
    - path: ".planning/scripts/compare-services-screenshots.ts"
      provides: "Visual diff generation script for services comparison"
      min_lines: 100
    - path: ".planning/audit/current/services-*.png"
      provides: "Current screenshots of services pages for comparison"
    - path: ".planning/audit/diffs/services-*-diff.png"
      provides: "Visual diff images highlighting regressions"
  key_links:
    - from: "capture-services-screenshots.ts"
      to: ".planning/audit/current/"
      via: "Playwright screenshot capture"
      pattern: "page.screenshot"
    - from: "compare-services-screenshots.ts"
      to: ".planning/audit/diffs/"
      via: "odiff pixel-level comparison"
      pattern: "odiff.*generateDiff"
---

<objective>
Capture screenshots of services pages, generate visual diffs against baseline, and verify all Phase 8 success criteria with pass/fail report.

Purpose: Phase 8 completes with verification that all deliverables meet quality standards. Screenshot capture across mobile/tablet/desktop viewports documents current state. Visual diff generation identifies any regressions from baseline. Success criteria verification confirms all requirements met: listing page layout, detail page formatting, image migration, filtering functionality, and visual parity.

Output: Verification report with 5/5 success criteria PASS, current screenshots of services pages, visual diff images showing no regressions, and documented QA checkpoint approval.
</objective>

<execution_context>
@/home/deck/.claude/get-shit-done/workflows/execute-plan.md
@/home/deck/.claude/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-section-polish---services/08-CONTEXT.md
@.planning/phases/07-section-polish---projects/07-04-PLAN.md
@.planning/phases/07-section-polish---projects/07-04-VERIFICATION.md
@pages/services/index.vue
@pages/services/[slug].vue
</context>

<tasks>

<task type="auto">
  <name>Create screenshot capture script for services pages</name>
  <files>.planning/scripts/capture-services-screenshots.ts</files>
  <action>
    Create .planning/scripts/capture-services-screenshots.ts to capture current services pages:

    1. Use Playwright for screenshot capture (already installed from Phase 7)

    2. Capture these URLs at 3 viewports (375px, 768px, 1920px):
       - /services (listing page with filters)
       - /services?category=structural (filtered view)
       - /services/structural-steel-design (detail with hero)
       - /services/concrete-design (detail with different hero)
       - /services/inspection-services (detail single-category)

    3. Save to .planning/audit/current/ with naming:
       services-listing-mobile.png
       services-listing-tablet.png
       services-listing-desktop.png
       services-filtered-mobile.png
       services-filtered-tablet.png
       services-filtered-desktop.png
       services-detail-steel-mobile.png
       services-detail-steel-tablet.png
       services-detail-steel-desktop.png
       services-detail-concrete-mobile.png
       services-detail-concrete-tablet.png
       services-detail-concrete-desktop.png
       services-detail-inspection-mobile.png
       services-detail-inspection-tablet.png
       services-detail-inspection-desktop.png

    4. Script structure (similar to Phase 7 capture-projects-screenshots.ts):
       - Import Playwright
       - Define URLs and viewports
       - Launch browser, navigate to localhost:3000
       - Wait for page load (waitUntil: 'networkidle')
       - Capture screenshots
       - Close browser

    5. Create directory if not exists:
       await fs.promises.mkdir('.planning/audit/current', { recursive: true })
  </action>
  <verify>npx tsx .planning/scripts/capture-services-screenshots.ts, verify .planning/audit/current/ directory contains 15 screenshots (5 pages x 3 viewports)</verify>
  <done>Screenshot capture script created, 15 screenshots captured across mobile/tablet/desktop viewports for services listing page (filtered and unfiltered) and 3 representative detail pages</done>
</task>

<task type="auto">
  <name>Create visual diff generation script for services comparison</name>
  <files>.planning/scripts/compare-services-screenshots.ts</files>
  <action>
    Create .planning/scripts/compare-services-screenshots.ts to generate visual diffs:

    1. Use odiff for pixel-level comparison (already configured from Phase 7)

    2. Compare baseline screenshots (if exist) vs current:
       Baseline location: .planning/audit/baselines/services-*.png
       Current location: .planning/audit/current/services-*.png
       Diff output: .planning/audit/diffs/services-*-diff.png

    3. Script structure (similar to Phase 7 compare-projects-screenshots.ts):
       - Import fs, odiff from odiff-bin
       - Read baseline and current directories
       - Generate diffs for matching pairs
       - Output diff percentage for each comparison
       - Create diffs directory if not exists

    4. Handle case where baselines don't exist:
       - Log message: "No baseline found for {filename}, skipping diff"
       - Continue with other comparisons

    5. For baseline services screenshots, capture from live site if not already in .planning/audit/baselines/:
       - If .planning/audit/baselines/services-listing-desktop.png doesn't exist
       - Capture from https://vp-associates.com/services using Playwright
  </action>
  <verify>npx tsx .planning/scripts/compare-services-screenshots.ts, verify .planning/audit/diffs/ directory contains diff images for each baseline comparison</verify>
  <done>Visual diff script created, diff images generated for services pages compared against baseline, diff percentages logged for each comparison</done>
</task>

<task type="auto">
  <name>Generate verification report with success criteria pass/fail</name>
  <files>.planning/phases/08-section-polish---services/08-04-VERIFICATION.md</files>
  <action>
    Create .planning/phases/08-section-polish---services/08-04-VERIFICATION.md:

    1. Report structure (similar to Phase 7 verification):
       # Phase 8: Section Polish - Services - Verification Report

       **Date:** [execution date]
       **Plans Completed:** 4 (08-01, 08-02, 08-03, 08-04)

       ## Success Criteria

       ### 1. Services listing page displays all services with proper card layout
       **Status:** PASS / FAIL
       **Evidence:**
       - All 10 services display in 2-column grid
       - Cards show icon, title, standard badge, description, capabilities
       - Responsive layout (1 column mobile, 2 column desktop)

       ### 2. Service detail pages show full content with proper formatting
       **Status:** PASS / FAIL
       **Evidence:**
       - Hero image displays with dark overlay
       - Content sections render correctly
       - "How This Service Works" process section displays
       - Related Services section shows same-category services

       ### 3. Service-related images migrated and displaying correctly
       **Status:** PASS / FAIL
       **Evidence:**
       - Hero images load from Phase 3 project images
       - All 10 services have mapped hero images
       - Fallback image configured
       - No 404 errors for images

       ### 4. Category/filtering functionality works as expected
       **Status:** PASS / FAIL
       **Evidence:**
       - Category filter pills display above grid
       - Clicking filter updates URL (?category=structural)
       - URL state persists on page reload
       - Results count updates correctly
       - Horizontal scroll works with hidden scrollbar

       ### 5. Visual comparison shows no regressions from live site baseline
       **Status:** PASS / FAIL
       **Evidence:**
       - Screenshots captured for all viewports
       - Visual diffs generated against baseline
       - No significant regressions identified
       - [Optional: Lighthouse scores if Chrome available]

       ## Summary

       **Overall Result:** 5/5 PASS

       All Phase 8 success criteria have been verified and met.

    2. Fill in actual results after testing:
       - Run through each criteria
       - Mark PASS or FAIL with evidence
       - Attach screenshot references
  </action>
  <verify>Read .planning/phases/08-section-polish---services/08-04-VERIFICATION.md, confirm all 5 success criteria have PASS/FAIL status with evidence</verify>
  <done>Verification report created with all 5 success criteria evaluated, each criteria includes status, evidence notes, and supporting screenshot references</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Phase 8 implementation: category filter pills on listing page, hero images on detail pages, 4-step process section, dynamic related services, and verification report with visual diffs</what-built>
  <how-to-verify>
    1. Start dev server: npm run dev

    2. Verify services listing page:
       - Navigate to http://localhost:3000/services
       - Confirm 2-column grid displays all 10 services
       - Click category pills and verify filter works
       - Check URL updates with ?category parameter
       - Reload page with filter active, verify persists

    3. Verify service detail pages:
       - Navigate to http://localhost:3000/services/structural-steel-design
       - Confirm hero image displays with overlay
       - Scroll down to "How This Service Works" section
       - Confirm 4-step process displays with numbered circles
       - Scroll to Related Services, confirm same-category services show

    4. Check visual diffs:
       - Open .planning/audit/diffs/ directory
       - Review any diff images (should show minimal/no changes if baselines exist)

    5. Read verification report:
       - Open .planning/phases/08-section-polish---services/08-04-VERIFICATION.md
       - Confirm 5/5 criteria show PASS

    6. Approve or describe issues:
       - If all looks good, type "approved"
       - If issues found, describe what needs fixing
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. Screenshot capture script executes without errors
2. 15 screenshots captured (5 pages x 3 viewports)
3. Visual diff script executes without errors
4. Diff images generated for baseline comparisons
5. Verification report created with all 5 success criteria evaluated
6. User checkpoint approved with no regressions identified
7. Phase 8 marked complete in ROADMAP.md
</verification>

<success_criteria>
- Services listing page displays all services in responsive 2-column grid
- Category filter pills work with URL state persistence
- Service detail pages show hero images from Phase 3 migration
- "How This Service Works" 4-step process section displays
- Related Services section dynamically shows same-category services
- All 10 service detail pages load without broken images
- Verification report shows 5/5 success criteria PASS
- User approves checkpoint with no regressions
</success_criteria>

<output>
After completion, create `.planning/phases/08-section-polish---services/08-04-SUMMARY.md`
</output>
