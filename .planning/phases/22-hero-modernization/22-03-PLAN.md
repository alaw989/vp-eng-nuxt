---
phase: 22-hero-modernization
plan: 03
type: execute
wave: 2
depends_on: ["22-01", "22-02"]
files_modified: [components/HeroStatic.vue, public/images/hero/]
autonomous: true

must_haves:
  truths:
    - "Background image is optimized (WebP format, < 200KB file size)"
    - "Image uses proper responsive srcset for mobile/desktop"
    - "Parallax effect is subtle and respects prefers-reduced-motion"
    - "Image alt text is descriptive and accessible"
    - "No layout shift (hero has explicit dimensions)"
  artifacts:
    - path: "components/HeroStatic.vue"
      provides: "Hero with optimized imagery and parallax"
      contains: "NuxtImg, parallax, reduced-motion check"
    - path: "public/images/hero/"
      provides: "Optimized hero background images"
      contains: "webp format images"
  key_links:
    - from: "components/HeroStatic.vue"
      to: "@nuxt/image"
      via: "NuxtImg component with optimization"
      pattern: "NuxtImg.*format.*webp"
    - from: "components/HeroStatic.vue"
      to: "VueUse"
      via: "useWindowScroll for parallax"
      pattern: "useWindowScroll"
---

<objective>
Optimize hero background imagery and implement subtle parallax animation that respects accessibility preferences.

Purpose: Ensure hero loads quickly (LCP < 2.5s) with proper image optimization, add engaging but non-distracting motion, and maintain accessibility for users who prefer reduced motion.

Output: HeroStatic with WebP-optimized background image, subtle parallax effect, proper responsive sizing, and full accessibility support.
</objective>

<execution_context>
@/Users/austinlaw/.claude/get-shit-done/workflows/execute-plan.md
@/Users/austinlaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-hero-modernization/22-RESEARCH.md
@components/HeroStatic.vue
@.planning/phases/17-accessibility-foundation/17-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Optimize background image with WebP and responsive sizing</name>
  <files>components/HeroStatic.vue, public/images/hero/</files>
  <action>
Update HeroStatic component with optimized image configuration:

1. Image optimization using NuxtImg:
   ```vue
   <NuxtImg
     :src="backgroundImage || '/images/hero/toronto-marina-1920w.jpg'"
     :alt="backgroundAlt || 'Tampa Bay waterfront development showcasing structural engineering expertise'"
     class="absolute inset-0 w-full h-full object-cover"
     format="webp"
     loading="eager"
     fetchpriority="high"
     width="1920"
     height="1080"
     :modifiers="{ quality: 85 }"
     :sizes="`(max-width: 768px) 100vw, (max-width: 1200px) 80vw, 1920px`"
     :srcset="`
       /images/hero/toronto-marina-640w.webp 640w,
       /images/hero/toronto-marina-1024w.webp 1024w,
       /images/hero/toronto-marina-1920w.webp 1920w
     `"
   />
   ```

2. If images don't exist in multiple sizes, convert/create them:
   - Check existing images in public/images/hero/
   - Use sharp CLI or ImageMagick to generate responsive variants:
     ```bash
     # Generate 640w for mobile
     convert input.jpg -resize 640x -quality 85 toronto-marina-640w.webp

     # Generate 1024w for tablet
     convert input.jpg -resize 1024x -quality 85 toronto-marina-1024w.webp

     # Generate 1920w for desktop (already exists)
     ```

3. Image selection guidelines (from research Priority 3):
   - Use local Tampa Bay project photos if available
   - Waterfront/marina images work well for regional context
   - Avoid generic stock architecture from non-Florida locations
   - Consider construction photos showing process, not just finished buildings

4. Fallback for non-WebP browsers:
   - NuxtImg automatically handles fallback to JPEG
   - Ensure original JPEG exists alongside WebP versions

5. Alt text best practices:
   - Describe the image content accurately
   - Include relevant keywords ("Tampa Bay", "structural engineering")
   - Keep under 125 characters
   - Don't repeat information already in text (headline)
  </action>
  <verify>
1. NuxtImg configured with format="webp", loading="eager", responsive sizes/srcset
2. Image files exist (check public/images/hero/ for webp variants)
3. Lighthouse shows LCP < 2.5s for hero image
  </verify>
  <done>Hero background image optimized with WebP format and responsive sizing</done>
</task>

<task type="auto">
  <name>Task 2: Implement subtle parallax with reduced-motion support</name>
  <files>components/HeroStatic.vue</files>
  <action>
Add subtle parallax effect to hero background using VueUse:

1. Import useWindowScroll from VueUse:
   ```typescript
   import { useWindowScroll } from '@vueuse/core'
   ```

2. Implement parallax offset:
   ```typescript
   const { y: scrollY } = useWindowScroll()

   // Parallax offset - background moves slower than foreground
   const parallaxOffset = computed(() => {
     // Only apply when user prefers motion
     if (prefersReducedMotion.value) return 0

     const maxOffset = 100 // Maximum pixels to translate (matches research)
     const offset = Math.min(scrollY.value * 0.3, maxOffset)
     return offset
   })
   ```

3. Check for reduced motion preference:
   ```typescript
   const prefersReducedMotion = ref(false)

   onMounted(() => {
     const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')
     prefersReducedMotion.value = mediaQuery.matches

     // Listen for changes
     const handleChange = (e: MediaQueryListEvent) => {
       prefersReducedMotion.value = e.matches
     }
     mediaQuery.addEventListener('change', handleChange)

     onUnmounted(() => {
       mediaQuery.removeEventListener('change', handleChange)
     })
   })
   ```

4. Apply parallax transform to background:
   ```vue
   <div
     class="absolute inset-0 w-full h-full overflow-hidden"
     :style="!prefersReducedMotion ? {
       transform: `translateY(${parallaxOffset}px)`,
       willChange: 'transform'
     } : {}"
   >
     <NuxtImg ... />
   </div>
   ```

5. CSS for GPU acceleration:
   ```css
   .parallax-container {
     will-change: transform;
     transform: translateZ(0); /* Force GPU layer */
   }

   @media (prefers-reduced-motion: reduce) {
     .parallax-container {
       will-change: auto;
       transform: none;
     }
   }
   ```

6. Accessibility verification:
   - Test with macOS reduced motion enabled (System Preferences > Accessibility > Display > Reduce motion)
   - Test with Windows reduced motion (Settings > Ease of Access > Display > Show animations)
   - Verify parallax is disabled when preference is on

7. Performance optimization:
   - Limit parallax to first 100vh of scroll (don't apply below fold)
   - Use maxOffset of 100px (matches research recommendations)
   - Apply will-change sparingly (only when motion is enabled)

Per research: "One animation technique maximum (subtle parallax OR scroll reveal, not both)"
  </action>
  <verify>
1. Parallax effect visible on scroll (subtle, not jerky)
2. Parallax disabled when prefers-reduced-motion is enabled
3. No performance issues (smooth 60fps on scroll)
  </verify>
  <done>Subtle parallax implemented with full reduced-motion accessibility support</done>
</task>

<task type="auto">
  <name>Task 3: Add explicit dimensions to prevent CLS</name>
  <files>components/HeroStatic.vue</files>
  <action>
Ensure hero has explicit dimensions to prevent Cumulative Layout Shift:

1. Container aspect ratio:
   ```vue
   <section
     class="relative h-[80vh] min-h-[600px] overflow-hidden bg-neutral-900"
     style="aspect-ratio: 16/9; max-height: 80vh;"
   >
   ```

2. Image explicit sizing:
   ```vue
   <NuxtImg
     ...
     width="1920"
     height="1080"
     style="aspect-ratio: 16/9;"
   />
   ```

3. Reserve space for image before load:
   - Add background color to container (bg-neutral-900)
   - Ensure image has min-height to prevent collapse

4. Test CLS:
   - Run Lighthouse audit
   - CLS score should be < 0.1 (Good threshold)
   - No layout shift when image loads

5. Mobile dimensions:
   - Ensure min-h-[600px] doesn't cause overflow on small screens
   - Consider using min-h-[400px] on mobile if needed
  </action>
  <verify>
1. Hero has explicit width/height on image
2. Container has fixed height (h-[80vh] or min-h-[600px])
3. Lighthouse CLS score < 0.1
  </verify>
  <done>Hero has explicit dimensions preventing layout shift</done>
</task>

</tasks>

<verification>
After all tasks complete:
- [ ] Background image optimized (WebP format, < 200KB)
- [ ] Responsive srcset configured for mobile/tablet/desktop
- [ ] NuxtImg configured with eager loading, high fetchpriority
- [ ] Subtle parallax effect (max 100px offset)
- [ ] Parallax disabled with prefers-reduced-motion
- [ ] Explicit dimensions set (no CLS)
- [ ] Alt text descriptive and accessible
- [ ] Lighthouse LCP < 2.5s, CLS < 0.1
</verification>

<success_criteria>
1. Hero loads quickly with optimized imagery
2. Subtle parallax adds visual interest without distraction
3. Full accessibility support (reduced motion respected)
4. No layout shift (explicit dimensions)
5. Performance targets met (LCP < 2.5s, CLS < 0.1)
</success_criteria>

<output>
After completion, create `.planning/phases/22-hero-modernization/22-03-SUMMARY.md`
</output>
