---
phase: 19-page-transitions
plan: 04
type: execute
wave: 2
depends_on: []
files_modified: []
autonomous: true

must_haves:
  truths:
    - "Route changes are announced to screen readers via aria-live region"
    - "Announcement uses aria-live='polite' priority (not assertive)"
    - "Announcement includes page title from route meta or generated from path"
    - "useA11yRouteAnnouncer is initialized in the app (likely in layouts/default.vue)"
  artifacts:
    - path: "composables/useA11y.ts"
      contains: "useA11yRouteAnnouncer"
      contains: "aria-live"
      min_lines: 30
  key_links:
    - from: "layouts/default.vue (or app.vue)"
      to: "composables/useA11y.ts"
      via: "useA11yRouteAnnouncer import and usage"
      pattern: "useA11yRouteAnnouncer"
---

<objective>
Verify that screen reader route announcements are working correctly (TRANS-04 already satisfied in Phase 17).

Purpose: TRANS-04 (route changes announced to screen readers) is already implemented in Phase 17 via useA11yRouteAnnouncer composable. This plan verifies the implementation is correct and working.

Output: Verification that route announcements work correctly for screen readers.
</objective>

<execution_context>
@/Users/austinlaw/.claude/get-shit-done/workflows/execute-plan.md
@/Users/austinlaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-page-transitions/19-CONTEXT.md
@.planning/phases/19-page-transitions/19-RESEARCH.md

# Prior work (Phase 17)
@composables/useA11y.ts (useA11yRouteAnnouncer already implemented)
@layouts/default.vue (may have useA11yRouteAnnouncer initialization)

# Research finding
"TRANS-04 already satisfied - The project has useA11yRouteAnnouncer composable working correctly"
</context>

<tasks>

<task type="auto">
  <name>Verify useA11yRouteAnnouncer composable exists</name>
  <files>composables/useA11y.ts</files>
  <action>
    Read composables/useA11y.ts and verify the useA11yRouteAnnouncer function exists and:

    1. Uses useAnnouncer with priority: 'polite' (not assertive)
    2. Watches route.path changes
    3. Calls announce() with page title on route change
    4. Has getPageTitle() helper that reads from route.meta.title or generates from path

    Expected implementation (already present from Phase 17):
    - useA11yRouteAnnouncer() function defined
    - watch(() => route.path, async (to, from) => {...})
    - await announce(`Navigated to ${title}`)

    This task verifies the implementation is correct. No changes needed unless issues found.
  </action>
  <verify>grep -A 20 "useA11yRouteAnnouncer" composables/useA11y.ts | grep -q "announce.*Navigated to"</verify>
  <done>useA11yRouteAnnouncer composable is correctly implemented</done>
</task>

<task type="auto">
  <name>Verify useA11yRouteAnnouncer is initialized</name>
  <files>layouts/default.vue</files>
  <action>
    Read layouts/default.vue and search for useA11yRouteAnnouncer usage:

    1. If found, verify it's called in <script setup>:
       ```vue
       <script setup lang="ts">
       useA11yRouteAnnouncer()
       </script>
       ```

    2. If NOT found, add it to the <script setup> section:
       ```vue
       <script setup lang="ts">
       // Other imports...

       // Initialize route announcer for screen readers (Phase 17)
       useA11yRouteAnnouncer()
       </script>
       ```

    3. Also check app.vue if it exists (may be initialized there instead)

    The composable must be called somewhere in the app to activate the route watcher.
    It's typically called in the main layout (default.vue) or app.vue.

    Note: This composable has no return value - calling it activates the watcher.
  </action>
  <verify>grep -q "useA11yRouteAnnouncer" layouts/default.vue || grep -q "useA11yRouteAnnouncer" app.vue 2>/dev/null || echo "Initialized in middleware or elsewhere"</verify>
  <done>useA11yRouteAnnouncer is initialized in the app</done>
</task>

<task type="auto">
  <name>Verify aria-live region is rendered</name>
  <files>layouts/default.vue</files>
  <action>
    In layouts/default.vue, verify there's an aria-live region element:

    Search for a div or span with aria-live="polite" attribute:
    ```vue
    <div aria-live="polite" aria-atomic="true" class="sr-only">
      {{ message }}
    </div>
    ```

    If NOT present, add it to the template (before the closing </template>):
    ```vue
    <!-- Live region for screen reader announcements -->
    <div aria-live="polite" aria-atomic="true" class="sr-only">
      {{ message }}
    </div>
    ```

    And add to <script setup>:
    ```vue
    <script setup lang="ts">
    const { message } = useAnnouncer({ priority: 'polite' })
    useA11yRouteAnnouncer()
    </script>
    ```

    The aria-live region is what screen readers actually announce. Without it,
    the announce() calls have nowhere to render messages.

    Use existing .sr-only utility class from main.css (already defined).
  </action>
  <verify>grep -q 'aria-live="polite"' layouts/default.vue</verify>
  <done>aria-live region is present in layout for screen reader announcements</done>
</task>

<task type="auto">
  <name>Verify route meta titles are set</name>
  <files>pages/index.vue</files>
  <action>
    Check a few page files to verify route.meta.title is set for better announcements:

    1. Read pages/index.vue - check for definePageMeta with title:
       ```vue
       <script setup lang="ts">
       definePageMeta({
         title: 'Home'
       })
       </script>
       ```

    2. Check pages/about.vue, pages/projects/index.vue similarly

    3. If titles are NOT set, add them to key pages:
       - index.vue: title: 'Home'
       - about.vue: title: 'About'
       - projects/index.vue: title: 'Projects'
       - services/index.vue: title: 'Services'
       - contact.vue: title: 'Contact'

    Route meta titles improve the announcement quality. Without them,
    useA11yRouteAnnouncer generates titles from path (e.g., "projects" from /projects).

    This is optional but recommended for better UX.
  </action>
  <verify>grep -r "definePageMeta" pages/ | head -5</verify>
  <done>Key pages have route meta titles defined</done>
</task>

</tasks>

<verification>
After completing all tasks:

1. Enable a screen reader (VoiceOver on macOS, NVDA on Windows, or TalkBack on Android):
   - macOS: Cmd + F5 to toggle VoiceOver
   - Windows: Ctrl + Win + Enter to toggle Narrator

2. Navigate between pages using NuxtLink clicks:
   - Home -> About
   - About -> Projects
   - Projects -> Services

3. Listen for announcements:
   - "Navigated to Home"
   - "Navigated to About"
   - "Navigated to Projects"

4. Verify announcements:
   - Use aria-live="polite" (not assertive) - doesn't interrupt current speech
   - Include page title from route.meta.title or generated from path
   - Announce on every route change

5. Test with DevTools Accessibility panel:
   - Inspect the aria-live region element
   - Verify aria-live="polite" and aria-atomic="true" attributes
   - Verify .sr-only class hides it visually
</verification>

<success_criteria>
1. useA11yRouteAnnouncer composable is correctly implemented
2. Composable is initialized in layouts/default.vue or app.vue
3. aria-live region exists in the template with aria-live="polite"
4. Route changes trigger announcements (verified with screen reader)
5. Key pages have route.meta.title defined for better announcements
</success_criteria>

<output>
After completion, create .planning/phases/19-page-transitions/19-04-SUMMARY.md
</output>
